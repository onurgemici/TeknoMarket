{"version":3,"file":"login-form-f.js.map","sources":["ng://login-form-f/lib/login-form/login-form.component.ts","ng://login-form-f/lib/google-login/google-login.component.ts","ng://login-form-f/lib/google-login/google-login.module.ts","ng://login-form-f/lib/login-form/login-form.module.ts"],"sourcesContent":["import {Component, Inject, OnInit} from '@angular/core';\r\nimport {FormBuilder, FormGroup, Validators} from '@angular/forms';\r\nimport {AuthFacade, NotificationService} from 'af-services';\r\nimport {Router} from '@angular/router';\r\n\r\n@Component({\r\n  selector: 'app-login-form',\r\n  templateUrl: './login-form.component.html',\r\n  styleUrls: ['./login-form.component.scss']\r\n})\r\nexport class LoginFormComponent implements OnInit {\r\n\r\n  form: FormGroup;\r\n  captchaSuccess = false;\r\n  show = false;\r\n  error;\r\n\r\n\r\n  callingControl: any;\r\n  captchaError = false;\r\n  constructor(private fb: FormBuilder, private authFacade: AuthFacade, private notify: NotificationService, @Inject('captchaKey') public captchaKey, @Inject('afterLoginRedirectTo') private afterLoginRedirectTo, private router: Router) { }\r\n\r\n  async ngOnInit() {\r\n\r\n    this.form = this.fb.group(\r\n      {\r\n\r\n        email: ['', Validators.compose([Validators.required, Validators.email])],\r\n        password: ['', Validators.compose([Validators.required, Validators.minLength(6)])]\r\n      }\r\n    );\r\n\r\n    await this.authFacade.readAndLoginWithToken('btnGoogle', (result) => {\r\n      this.onSuccessfulLogin(result);\r\n\r\n    }, e => {\r\n    });\r\n\r\n  }\r\n\r\n  async submit(callingControl) {\r\n    this.callingControl = callingControl;\r\n    if (!this.error) {\r\n      this.doLogin(callingControl);\r\n    } else if (this.captchaSuccess) {\r\n      this.doLogin(callingControl);\r\n    }\r\n  }\r\n\r\n  showHidePassword() {\r\n    this.show = !this.show;\r\n  }\r\n\r\n  handleSuccessCaptcha($event: string) {\r\n    this.form.patchValue({\r\n      captcha: $event\r\n    });\r\n    this.captchaSuccess = true;\r\n\r\n  }\r\n\r\n  private doLogin(callingControl) {\r\n    this.captchaSuccess = false;\r\n    this.error = undefined;\r\n\r\n    this.authFacade.loginWIthUsernameAndPassword(this.form.value, callingControl, (result) => {\r\n      this.onSuccessfulLogin(result);\r\n\r\n    }, e => {\r\n      this.error = e;\r\n    });\r\n  }\r\n\r\n  private onSuccessfulLogin(result) {\r\n    const redirectTo = localStorage.getItem('redirectTo');\r\n    if (redirectTo) {\r\n      this.notify.info('Redirecting...', 'Please Wait', 10000, true, true);\r\n      localStorage.removeItem('redirectTo');\r\n      window.location.href = redirectTo;\r\n      return;\r\n    }\r\n    if (result.isMTurk) {\r\n      this.router.navigate([this.afterLoginRedirectTo]);\r\n\r\n      return;\r\n    }\r\n    if (window.opener) {\r\n\r\n      window.close();\r\n    } else {\r\n      this.router.navigate([this.afterLoginRedirectTo]);\r\n    }\r\n  }\r\n\r\n}\r\n","import {Component, EventEmitter, Input, OnInit, Output} from '@angular/core';\r\nimport {AuthFacade} from 'af-services';\r\n\r\n\r\n\r\n@Component({\r\n  selector: 'app-google-login',\r\n  templateUrl: './google-login.component.html',\r\n  styleUrls: ['./google-login.component.scss']\r\n})\r\nexport class GoogleLoginComponent implements OnInit {\r\n\r\n  @Input() isModal = false;\r\n  @Input() saveAndRedirectToCurrentPage = false;\r\n  @Output() done = new EventEmitter<any>();\r\n\r\n  constructor(private authFacade: AuthFacade) {\r\n  }\r\n\r\n\r\n  async ngOnInit() {\r\n\r\n\r\n  }\r\n\r\n  showLoading() {\r\n    if (this.isModal) {\r\n      this.authFacade.loginViaGoogleInModal(() => {\r\n        this.done.emit();\r\n\r\n      });\r\n    } else {\r\n      if (this.saveAndRedirectToCurrentPage) {\r\n        localStorage.setItem('redirectTo', window.location.href);\r\n      } else {\r\n        localStorage.removeItem('redirectTo');\r\n      }\r\n      this.authFacade.googleLogin('btnGoogle');\r\n    }\r\n\r\n  }\r\n}\r\n","import {CommonModule} from '@angular/common';\r\nimport {NgModule} from '@angular/core';\r\nimport {GoogleLoginComponent} from './google-login.component';\r\n\r\n@NgModule({\r\n  declarations: [GoogleLoginComponent],\r\n  imports: [\r\n    CommonModule\r\n  ],\r\n  exports: [GoogleLoginComponent]\r\n})\r\nexport class  GoogleLoginModule {\r\n}\r\n","import {CommonModule} from '@angular/common';\r\nimport {NgModule} from '@angular/core';\r\n\r\nimport {NgxCaptchaModule} from 'ngx-captcha';\r\nimport {FormsModule, ReactiveFormsModule} from '@angular/forms';\r\nimport {LoginFormComponent} from './login-form.component';\r\nimport {GoogleLoginModule} from '../google-login/google-login.module';\r\n\r\n@NgModule({\r\n  declarations: [LoginFormComponent],\r\n  imports: [\r\n    CommonModule,\r\n    NgxCaptchaModule,\r\n    GoogleLoginModule, FormsModule, ReactiveFormsModule\r\n\r\n  ],\r\n  exports: [LoginFormComponent], providers: []\r\n})\r\nexport class LoginFormModule {\r\n}\r\n\r\nexport function LoginFormModuleExport() {\r\n  return LoginFormModule;\r\n}\r\n"],"names":[],"mappings":"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"}
